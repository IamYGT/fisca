import{r as y,j as r,h as b,y as l}from"./app-CzQgzLDV.js";import{w as f,x as m}from"./index-DnFmWr2M.js";import{r as n}from"./menu-0vx0Mz6b.js";import{A as j}from"./index-BdO7F12x.js";import{m as k}from"./proxy-CgUF6eMH.js";import"./iconBase-aArZRAXf.js";import"./index-C7UQo0Vh.js";import"./portal-ssQOh7ct.js";import"./use-server-handoff-complete-CR0MK-dB.js";function I({currentStatus:t,statuses:p,onChange:x,isLoading:s=!1,t:a,ticketId:h}){const[o,d]=y.useState(!1),c=e=>{switch(e){case"open":return"text-blue-500";case"answered":return"text-green-500";case"closed":return"text-gray-500";default:return"text-gray-500"}},g=async e=>{d(!0);const i=new FormData;i.append("_method","PUT"),i.append("status",e);try{await b.post(route("admin.tickets.update-status",h),{_method:"PUT",status:e},{preserveScroll:!0,onSuccess:()=>{x(e),l.success(a("ticket.statusUpdated"))},onError:()=>{l.error(a("common.error"))},onFinish:()=>{d(!1)}})}catch(u){console.error("Status update error:",u),l.error(a("common.error")),d(!1)}};return r.jsxs(n,{as:"div",className:"relative",children:[r.jsxs(n.Button,{className:"flex items-center gap-2 rounded-xl border-2 border-gray-200 bg-white px-4 py-2 text-sm font-medium transition-colors hover:border-gray-300 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600",disabled:s||o,children:[s||o?r.jsx(f,{className:"h-4 w-4 animate-spin"}):r.jsx(m,{className:`h-2 w-2 ${c(t)}`}),r.jsx("span",{children:a(`ticket.status.${t}`)}),r.jsx("svg",{className:"ml-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r.jsx(j,{children:r.jsx(n.Items,{as:k.div,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 z-50 mt-2 w-48 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-800",children:r.jsx("div",{className:"py-1",children:p.map(e=>r.jsx(n.Item,{children:({active:i})=>r.jsxs("button",{onClick:()=>g(e),disabled:s||o||e===t,className:`${i?"bg-gray-100 dark:bg-gray-700":""} ${t===e?"bg-gray-50 dark:bg-gray-700":""} ${s||o?"cursor-not-allowed opacity-50":""} flex w-full items-center gap-2 px-4 py-2 text-sm`,children:[r.jsx(m,{className:`h-2 w-2 ${c(e)}`}),a(`ticket.status.${e}`)]})},e))})})})]})}export{I as default};

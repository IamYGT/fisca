import{r as y,j as e,h as b,y as l}from"./app-CNMlmVvg.js";import{w as f,x as m}from"./index-CJWvZLX-.js";import{r as n}from"./menu-jRJMisdK.js";import{A as j}from"./index-D-9bM9oj.js";import{m as k}from"./proxy-Bs2RKMmf.js";import"./iconBase-Cyj80Zr6.js";import"./index-CunF7zry.js";import"./portal-CUWHgd5s.js";import"./use-server-handoff-complete-Dx_XkveX.js";function I({currentStatus:t,statuses:p,onChange:x,isLoading:s=!1,t:a,ticketId:u}){const[o,d]=y.useState(!1),c=r=>{switch(r){case"open":return"text-blue-500";case"answered":return"text-green-500";case"closed":return"text-gray-500";default:return"text-gray-500"}},g=async r=>{d(!0);const i=new FormData;i.append("_method","PUT"),i.append("status",r);try{await b.put(route("management.admin.tickets.update-status",u),{status:r},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{x(r),l.success(a("tickets.statusUpdated"))},onError:()=>{l.error(a("common.error"))},onFinish:()=>{d(!1)}})}catch(h){console.error("Status update error:",h),l.error(a("common.error")),d(!1)}};return e.jsxs(n,{as:"div",className:"relative",children:[e.jsxs(n.Button,{className:"flex items-center gap-2 rounded-xl border-2 border-gray-200 bg-white px-4 py-2 text-sm font-medium transition-colors hover:border-gray-300 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:border-gray-600",disabled:s||o,children:[s||o?e.jsx(f,{className:"h-4 w-4 animate-spin"}):e.jsx(m,{className:`h-2 w-2 ${c(t)}`}),e.jsx("span",{children:a(`ticket.status.${t}`)}),e.jsx("svg",{className:"ml-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx(j,{children:e.jsx(n.Items,{as:k.div,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 z-50 mt-2 w-48 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-lg dark:border-gray-700 dark:bg-gray-800",children:e.jsx("div",{className:"py-1",children:p.map(r=>e.jsx(n.Item,{children:({active:i})=>e.jsxs("button",{onClick:()=>g(r),disabled:s||o||r===t,className:`${i?"bg-gray-100 dark:bg-gray-700":""} ${t===r?"bg-gray-50 dark:bg-gray-700":""} ${s||o?"cursor-not-allowed opacity-50":""} flex w-full items-center gap-2 px-4 py-2 text-sm`,children:[e.jsx(m,{className:`h-2 w-2 ${c(r)}`}),a(`ticket.status.${r}`)]})},r))})})})]})}export{I as default};

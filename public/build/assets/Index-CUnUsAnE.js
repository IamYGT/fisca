import{u as K,r as i,a as Q,h as m,j as e,M as W,U as S}from"./app-CNMlmVvg.js";import{d as q,P as G}from"./debounce-CwYw20WO.js";import{A as H}from"./AuthenticatedLayout-COLO9gVE.js";import{I as X,J as Z,i as C,c as T,l as ee,K as I,m as ae,f as te,E as re,L as se,g as ne,e as le,M as ie,N as de,O as D,j as ce,C as oe,P as me}from"./index-CJWvZLX-.js";import{m as d}from"./proxy-Bs2RKMmf.js";import{z as xe}from"./transition-Dmm_GqZM.js";import{A as ue}from"./index-D-9bM9oj.js";import{r as x}from"./menu-jRJMisdK.js";import"./ApplicationLogo-BLXO_E4I.js";import"./iconBase-Cyj80Zr6.js";import"./index-CunF7zry.js";import"./use-server-handoff-complete-Dx_XkveX.js";import"./portal-CUWHgd5s.js";function Ce({auth:L,transactions:y,filters:b,statuses:R,types:U,stats:n}){const{t}=K(),[j,w]=i.useState(!1),[u,h]=i.useState(!1),[p,$]=i.useState(!0),{data:r,setData:c}=Q({search:b.search||"",status:b.status||"",type:b.type||""});i.useEffect(()=>{$(!1)},[]);const A=i.useCallback(()=>{u||(h(!0),w(!1),c({search:"",status:"",type:""}),m.get(route("admin.transactions.index"),{},{preserveState:!0,preserveScroll:!0,onFinish:()=>h(!1)}))},[u,c]),k=i.useMemo(()=>q(a=>{if(!p){h(!0);const l=a.trim();m.get(route("admin.transactions.index"),{search:l,status:r.status,type:r.type},{preserveState:!0,preserveScroll:!0,onFinish:()=>h(!1)})}},300),[r.status,r.type,p]);i.useEffect(()=>{!p&&r.search&&k(r.search)},[r.search]);const g={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},E={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},F=a=>{const l=y.data.map(s=>({reference_id:s.reference_id,user:s.user.name,email:s.user.email,type:s.type,amount:s.amount,amount_usd:s.amount_usd,exchange_rate:s.exchange_rate,status:s.status,bank_account:s.bank_account,bank_id:s.bank_id,crypto_address:s.crypto_address,crypto_network:s.crypto_network,crypto_fee:s.crypto_fee,crypto_txid:s.crypto_txid,processed_at:s.processed_at?new Date(s.processed_at).toLocaleDateString("tr-TR"):"",created_at:new Date(s.created_at).toLocaleDateString("tr-TR"),updated_at:new Date(s.updated_at).toLocaleDateString("tr-TR"),notes:s.notes}));let f,v,N;a==="json"?(f=JSON.stringify(l,null,2),v="application/json",N="json"):(f=[[t("transaction.referenceId"),t("transaction.user"),t("common.email"),t("transaction.type"),t("transaction.amount"),t("transaction.amountUsd"),t("transaction.exchangeRate"),t("transaction.status"),t("transaction.bankAccount"),t("transaction.bank"),t("transaction.cryptoAddress"),t("transaction.cryptoNetwork"),t("transaction.cryptoFee"),t("transaction.cryptoTxid"),t("transaction.processedAt"),t("transaction.createdAt"),t("transaction.updatedAt"),t("transaction.notes")].join(","),...l.map(J=>Object.values(J).map(Y=>`"${Y}"`).join(","))].join(`
`),v="text/csv",N="csv");const z=`${t("transaction.transactions")}_${new Date().toISOString().split("T")[0]}.${N}`,V=new Blob([f],{type:v}),_=window.URL.createObjectURL(V),o=document.createElement("a");o.href=_,o.download=z,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(_)},O=a=>{switch(a){case"completed":return"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300";case"cancelled":return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300";case"rejected":return"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300"}},B=a=>{switch(a){case"bank_withdrawal":return"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300";case"crypto_withdrawal":return"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300"}},M=a=>{switch(a){case"completed":return e.jsx(ce,{className:"h-4 w-4 text-green-500"});case"pending":return e.jsx(C,{className:"h-4 w-4 text-yellow-500"});case"cancelled":return e.jsx(D,{className:"h-4 w-4 text-gray-500"});case"rejected":return e.jsx(D,{className:"h-4 w-4 text-red-500"});default:return e.jsx(de,{className:"h-4 w-4 text-gray-500"})}},P=a=>{switch(a){case"bank_withdrawal":return e.jsx(me,{className:"h-4 w-4"});case"crypto_withdrawal":return e.jsx(oe,{className:"h-4 w-4"});default:return e.jsx(T,{className:"h-4 w-4"})}};return e.jsxs(H,{auth:L,header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:t("admin.transactions")}),children:[e.jsx(W,{title:t("admin.transactions")}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsxs(d.div,{initial:"hidden",animate:"visible",variants:E,className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(d.div,{variants:g,className:"group overflow-hidden rounded-xl bg-gradient-to-br from-blue-50 to-blue-100 p-6 shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg dark:from-blue-900/30 dark:to-blue-800/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:t("stats.totalTransactions")}),e.jsx("h3",{className:"mt-2 text-3xl font-bold text-blue-700 dark:text-blue-300",children:n.counts.total.toLocaleString()}),e.jsx("div",{className:"mt-2 text-xs text-blue-500 dark:text-blue-400",children:t("stats.todayCount",{count:n.today.count})})]}),e.jsx(X,{className:"h-12 w-12 text-blue-500/50 transition-transform group-hover:scale-110"})]})}),e.jsx(d.div,{variants:g,className:"group overflow-hidden rounded-xl bg-gradient-to-br from-green-50 to-green-100 p-6 shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg dark:from-green-900/30 dark:to-green-800/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:t("stats.completedTransactions")}),e.jsx("h3",{className:"mt-2 text-3xl font-bold text-green-700 dark:text-green-300",children:n.counts.completed.toLocaleString()}),e.jsxs("div",{className:"mt-2 text-xs text-green-500 dark:text-green-400",children:[(n.counts.completed/n.counts.total*100).toFixed(1),"%"]})]}),e.jsx(Z,{className:"h-12 w-12 text-green-500/50 transition-transform group-hover:scale-110"})]})}),e.jsx(d.div,{variants:g,className:"group overflow-hidden rounded-xl bg-gradient-to-br from-amber-50 to-amber-100 p-6 shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg dark:from-amber-900/30 dark:to-amber-800/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-600 dark:text-amber-400",children:t("stats.pendingTransactions")}),e.jsx("h3",{className:"mt-2 text-3xl font-bold text-amber-700 dark:text-amber-300",children:n.counts.pending.toLocaleString()}),e.jsxs("div",{className:"mt-2 text-xs text-amber-500 dark:text-amber-400",children:[(n.counts.pending/n.counts.total*100).toFixed(1),"%"]})]}),e.jsx(C,{className:"h-12 w-12 text-amber-500/50 transition-transform group-hover:scale-110"})]})}),e.jsx(d.div,{variants:g,className:"group overflow-hidden rounded-xl bg-gradient-to-br from-purple-50 to-purple-100 p-6 shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg dark:from-purple-900/30 dark:to-purple-800/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:t("stats.totalVolume")}),e.jsx("h3",{className:"mt-2 text-3xl font-bold text-purple-700 dark:text-purple-300",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(n.total_usd)}),e.jsx("div",{className:"mt-2 text-xs text-purple-500 dark:text-purple-400",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",maximumFractionDigits:0}).format(n.total_try)})]}),e.jsx(T,{className:"h-12 w-12 text-purple-500/50 transition-transform group-hover:scale-110"})]})})]}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"overflow-hidden rounded-xl bg-white shadow-sm dark:bg-gray-800",children:[e.jsxs("div",{className:"border-b border-gray-200 p-6 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"relative flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"focus:ring-primary-500 w-full rounded-xl border-gray-200 py-3 pl-12 pr-4 text-base transition-all focus:ring-2 dark:border-gray-600 dark:bg-gray-700/50",placeholder:t("common.searchPlaceholder"),value:r.search,onChange:a=>{const l=a.target.value;if(c("search",l),!l.trim()){m.get(route("admin.transactions.index"),{...r,search:""},{preserveState:!0,preserveScroll:!0});return}k(l)}}),e.jsx(ee,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),u&&e.jsx(I,{className:"absolute right-4 top-1/2 h-5 w-5 -translate-y-1/2 animate-spin text-gray-400"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>w(!j),className:`flex items-center rounded-xl px-4 py-2.5 transition-all ${j?"bg-primary-100 text-primary-700 dark:bg-primary-900/30 dark:text-primary-300":"bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600"}`,children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),t("common.filters"),(r.status||r.type)&&e.jsx("span",{className:"bg-primary-500 ml-2 rounded-full px-2 py-0.5 text-xs text-white",children:[r.status,r.type].filter(Boolean).length})]}),(r.status||r.type||r.search)&&e.jsx("button",{onClick:A,className:"rounded-xl px-4 py-2.5 text-gray-600 transition-all hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",children:t("common.reset")}),e.jsxs(x,{as:"div",className:"relative",children:[e.jsxs(x.Button,{className:"group flex items-center rounded-xl bg-primary-600 px-4 py-2.5 font-medium text-white shadow-sm transition-all duration-200 hover:bg-primary-700 hover:shadow dark:bg-primary-700 dark:hover:bg-primary-600",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),t("common.export")]}),e.jsx(xe,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:e.jsx(x.Items,{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none dark:bg-gray-700",children:e.jsxs("div",{className:"p-1",children:[e.jsx(x.Item,{children:({active:a})=>e.jsxs("button",{onClick:()=>F("json"),className:`${a?"bg-gray-100 dark:bg-gray-600":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-900 dark:text-gray-100`,children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"JSON"]})}),e.jsx(x.Item,{children:({active:a})=>e.jsxs("button",{onClick:()=>F("csv"),className:`${a?"bg-gray-100 dark:bg-gray-600":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-900 dark:text-gray-100`,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"CSV"]})})]})})})]})]})]}),e.jsx(ue,{children:j&&e.jsx(d.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 rounded-xl bg-gray-50 p-4 dark:bg-gray-700/30 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("transaction.status")}),e.jsxs("select",{value:r.status,onChange:a=>{c("status",a.target.value),m.get(route("admin.transactions.index"),{...r,status:a.target.value},{preserveState:!0})},className:"w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700",children:[e.jsx("option",{value:"",children:t("common.all")}),R.map(a=>e.jsx("option",{value:a,children:t(`status.${a}`)},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:t("transaction.type")}),e.jsxs("select",{value:r.type,onChange:a=>{c("type",a.target.value),m.get(route("admin.transactions.index"),{...r,type:a.target.value},{preserveState:!0})},className:"w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700",children:[e.jsx("option",{value:"",children:t("common.all")}),U.map(a=>e.jsx("option",{value:a,children:t(`transaction.${a}`)},a))]})]})]})})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-xs uppercase dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:t("transaction.referenceId")}),e.jsx("th",{className:"px-4 py-3",children:t("transaction.user")}),e.jsx("th",{className:"hidden px-4 py-3 md:table-cell",children:t("transaction.type")}),e.jsx("th",{className:"px-4 py-3",children:t("transaction.amount")}),e.jsx("th",{className:"px-4 py-3",children:t("transaction.status")}),e.jsx("th",{className:"hidden px-4 py-3 lg:table-cell",children:t("transaction.lastUpdate")}),e.jsx("th",{className:"w-20 px-4 py-3",children:t("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y.data.map(a=>e.jsxs("tr",{className:"bg-white hover:bg-gray-50 dark:bg-gray-800 dark:hover:bg-gray-700/50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:e.jsx("span",{className:"text-xs",children:a.reference_id})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"hidden h-7 w-7 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-700 sm:flex",children:e.jsx(ne,{className:"h-3 w-3 text-gray-500"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate font-medium",children:a.user.name}),e.jsx("div",{className:"truncate text-xs text-gray-500",children:a.user.email})]})]})}),e.jsx("td",{className:"hidden px-4 py-3 md:table-cell",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded px-2 py-0.5 text-xs font-medium ${B(a.type)}`,children:[P(a.type),e.jsx("span",{className:"ml-1",children:t(`transaction.${a.type}`)})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(parseFloat(a.amount_usd))}),e.jsx("span",{className:"text-xs text-gray-500",children:new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(parseFloat(a.amount))}),e.jsxs("span",{className:"text-xs text-gray-400",children:[t("transaction.rate"),":"," ",a.exchange_rate?Number(a.exchange_rate).toFixed(4):"-"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded px-2 py-0.5 text-xs font-medium ${O(a.status)}`,children:[M(a.status),e.jsx("span",{className:"ml-1",children:t(`status.${a.status}`)})]})}),e.jsx("td",{className:"hidden px-4 py-3 lg:table-cell",children:e.jsx("span",{className:"text-xs text-gray-500",children:new Date(a.updated_at).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(S,{href:route("management.admin.transactions.show",a.id),className:"p-1 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(S,{href:route("management.admin.transactions.edit",a.id),className:"p-1 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},a.id))})]})}),e.jsx("div",{className:"border-t border-gray-200 p-4 dark:border-gray-700",children:e.jsx(G,{links:y.links})})]})]})}),u&&!p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm dark:bg-black/40",children:e.jsx("div",{className:"rounded-xl bg-white p-4 shadow-lg dark:bg-gray-800",children:e.jsx(I,{className:"text-primary-600 h-8 w-8 animate-spin"})})})]})}export{Ce as default};

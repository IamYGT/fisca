var _=Object.defineProperty;var U=(a,s,i)=>s in a?_(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i;var $=(a,s,i)=>U(a,typeof s!="symbol"?s+"":s,i);import{r as l,j as e,u as I,a as H,M,h as C,U as z}from"./app-CNMlmVvg.js";import{A as O}from"./AuthenticatedLayout-COLO9gVE.js";import{a as D,i as Y,j as q,k as G,l as J,m as K,e as Q}from"./index-CJWvZLX-.js";import{d as V,P as W}from"./debounce-CwYw20WO.js";import{A as X}from"./index-D-9bM9oj.js";import{m as Z}from"./proxy-Bs2RKMmf.js";import"./ApplicationLogo-BLXO_E4I.js";import"./iconBase-Cyj80Zr6.js";import"./index-CunF7zry.js";class ee extends l.Component{constructor(){super(...arguments);$(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,g){console.error("ErrorBoundary yakaladı:",i,g)}render(){var i;return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-xl w-full mx-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Bir Hata Oluştu"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Sayfa yüklenirken beklenmeyen bir hata oluştu. Lütfen sayfayı yenileyin veya daha sonra tekrar deneyin."}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-4 mb-4",children:e.jsx("pre",{className:"text-sm text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:(i=this.state.error)==null?void 0:i.message})}),e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:"Sayfayı Yenile"})]})})}):this.props.children}}const b=({title:a,value:s,icon:i,color:g,textColor:j,onClick:h})=>e.jsx("div",{className:`${g} rounded-2xl shadow-sm p-6 ${j} ${h?"cursor-pointer hover:opacity-90 transition-opacity":""}`,onClick:h,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:a}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:s})]}),e.jsx("div",{className:"p-3 bg-white/10 rounded-xl",children:e.jsx(i,{className:"w-6 h-6"})})]})});function he({auth:a,tickets:s,filters:i={},statuses:g,priorities:j,categories:h,stats:u}){const{t}=I(),[y,S]=l.useState(!1),[F,f]=l.useState(!1),[k,A]=l.useState(!0),v={search:"",status:"",priority:"",category:"",sort:"",direction:"asc",page:"1"},{data:n,setData:o,reset:R}=H({...v,...i}),[x,B]=l.useState({column:n.sort||"",direction:n.direction||"asc"}),w=()=>{R();const r=route("management.admin.tickets.index");r?C.get(r,v):console.error("Route bulunamadı: management.admin.tickets.index")},p=r=>{const d=route("management.admin.tickets.index");if(!d){console.error("Route bulunamadı: management.admin.tickets.index");return}C.get(d,{...r,page:"1"},{preserveState:!0,preserveScroll:!1,onBefore:()=>f(!0),onFinish:()=>{f(!1),S(!1)},onError:()=>{f(!1),w()}})},P=l.useCallback(V(r=>{if(!k){const d={...n,search:r,page:"1"};o(d),p(d)}},300),[n,k]);l.useEffect(()=>{k||p(n)},[n.status,n.priority,n.category]);const L=l.useCallback(r=>{const d=x.column===r&&x.direction==="asc"?"desc":"asc";B({column:r,direction:d});const E={...n,sort:r,direction:d,page:"1"};o(E),p(E)},[x,n]),N=(r,d)=>{const c={...v,[r]:d,page:"1"};o(c),p(c)},m=({column:r,children:d})=>{const c=x.column===r;return e.jsx("th",{scope:"col",className:`px-6 py-4 text-left text-xs font-medium tracking-wider whitespace-nowrap cursor-pointer transition-colors
                    ${c?"text-indigo-600 dark:text-indigo-400":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,onClick:()=>L(r),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:d}),c&&e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400",children:x.direction==="asc"?"↑":"↓"})]})})};return l.useEffect(()=>{A(!1)},[]),e.jsx(ee,{children:e.jsxs(O,{auth:a,children:[e.jsx(M,{title:t("admin.tickets")}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(b,{title:t("stats.totalTickets"),value:u.total,icon:D,color:"bg-gradient-to-br from-indigo-500 to-purple-600",textColor:"text-white",onClick:w}),e.jsx(b,{title:t("stats.openTickets"),value:u.open,icon:Y,color:"bg-gradient-to-br from-amber-500 to-orange-600",textColor:"text-white",onClick:()=>N("status","open")}),e.jsx(b,{title:t("stats.answeredTickets"),value:u.answered,icon:q,color:"bg-gradient-to-br from-emerald-500 to-teal-600",textColor:"text-white",onClick:()=>N("status","answered")}),e.jsx(b,{title:t("stats.highPriority"),value:u.high_priority,icon:G,color:"bg-gradient-to-br from-rose-500 to-red-600",textColor:"text-white",onClick:()=>N("priority","high")})]}),s.data.length===0&&!F&&e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-2xl shadow-sm",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-600"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:t("ticket.noTickets")}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:t("ticket.noTicketsDescription")}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:w,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:t("common.resetFilters")})})]}),F&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm overflow-hidden border border-gray-200/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:t("admin.tickets")}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("input",{type:"text",placeholder:t("common.search"),className:"w-full pl-12 pr-4 py-3 rounded-xl border-0 ring-1 ring-gray-200 dark:ring-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400 transition-shadow duration-150",value:n.search,onChange:r=>{o("search",r.target.value),P(r.target.value)}}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(J,{className:"w-4 h-4 text-gray-400"})})]})]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>S(!y),className:`inline-flex items-center px-5 py-3 rounded-xl text-sm font-medium transition-all duration-150
                                                ${y?"bg-indigo-500 text-white hover:bg-indigo-600":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:[e.jsx(K,{className:`w-4 h-4 mr-2 ${y?"text-white":"text-gray-500 dark:text-gray-400"}`}),t("common.filters")]})})]}),e.jsx(X,{children:y&&e.jsx(Z.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"mt-6",children:e.jsx("div",{className:"p-6 bg-gradient-to-b from-gray-50 to-white dark:from-gray-800 dark:to-gray-750 rounded-xl border border-gray-200/50 dark:border-gray-700/50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("ticket.status")}),e.jsxs("select",{value:n.status,onChange:r=>o("status",r.target.value),className:"w-full py-3 pl-4 pr-10 rounded-xl border-0 ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400",children:[e.jsx("option",{value:"",children:t("ticket.allStatuses")}),g.map(r=>e.jsx("option",{value:r,children:t(`ticket.status.${r}`)},r))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("ticket.priority")}),e.jsxs("select",{value:n.priority,onChange:r=>o("priority",r.target.value),className:"w-full py-3 pl-4 pr-10 rounded-xl border-0 ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400",children:[e.jsx("option",{value:"",children:t("ticket.allPriorities")}),j.map(r=>e.jsx("option",{value:r,children:t(`ticket.priority.${r}`)},r))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("ticket.category")}),e.jsxs("select",{value:n.category,onChange:r=>o("category",r.target.value),className:"w-full py-3 pl-4 pr-10 rounded-xl border-0 ring-1 ring-gray-200 dark:ring-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400",children:[e.jsx("option",{value:"",children:t("ticket.allCategories")}),h.map(r=>e.jsx("option",{value:r,children:t(`ticket.category.${r}`)},r))]})]})]})})})})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 dark:bg-gray-800/50",children:[e.jsx(m,{column:"subject",children:t("ticket.subject")}),e.jsx(m,{column:"user",children:t("ticket.user")}),e.jsx(m,{column:"priority",children:t("ticket.priority")}),e.jsx(m,{column:"status",children:t("ticket.status")}),e.jsx(m,{column:"last_reply_at",children:t("ticket.lastReply")}),e.jsx("th",{scope:"col",className:"px-6 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",children:t("common.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:s.data.map((r,d)=>e.jsxs("tr",{className:`group hover:bg-gray-50/50 dark:hover:bg-gray-700/50 transition-colors duration-150 ${d%2===0?"bg-white dark:bg-gray-800":"bg-gray-50/30 dark:bg-gray-800/30"}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 group relative",title:r.subject,children:[e.jsx("div",{className:"hidden md:block",children:e.jsx("span",{className:"cursor-help",children:T(r.subject,60)})}),e.jsx("div",{className:"md:hidden",children:e.jsx("span",{className:"cursor-help",children:T(r.subject,30)})}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 dark:bg-gray-700 text-white text-xs rounded-lg py-2 px-3 -top-10 left-1/2 transform -translate-x-1/2 w-auto max-w-xs",children:[r.subject,e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-1/2 rotate-45 w-2 h-2 bg-gray-900 dark:bg-gray-700"})]})]}),e.jsxs("div",{className:"md:hidden mt-1 flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center mr-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-300",children:r.user.name.charAt(0).toUpperCase()})}),e.jsx("span",{className:"truncate max-w-[120px]",children:r.user.name})]})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap hidden md:table-cell",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:r.user.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 cursor-pointer hover:text-indigo-600 dark:hover:text-indigo-400",onClick:()=>{o("search",r.user.name),C.get(route("managment.admin.tickets.index",{search:r.user.name}))},children:r.user.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-[200px]",children:r.user.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(re,{priority:r.priority})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx(te,{status:r.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500 dark:text-gray-400 hidden lg:table-cell",children:ae(r.last_reply_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:e.jsx("div",{className:"flex items-center justify-end space-x-3",children:e.jsx(z,{href:route("management.admin.tickets.show",r.id),className:"p-2 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors duration-150 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Q,{className:"w-5 h-5"})})})})]},r.id))})]})})}),e.jsx("div",{className:"sticky bottom-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsx(W,{links:s.links})})]})]})]})})]})})}const re=({priority:a})=>{const s={low:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",high:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s[a]}`,children:a})},te=({status:a})=>{const s={open:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",answered:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",closed:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s[a]}`,children:a})},ae=a=>new Date(a).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),T=(a,s)=>a.length<=s?a:a.substring(0,s)+"...";export{he as default};

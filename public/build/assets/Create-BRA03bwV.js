import{u as C,r as T,a as A,j as e,M as z,y as d}from"./app-CzQgzLDV.js";import{A as S}from"./AuthenticatedLayout-DK_-UJtt.js";import{f as E}from"./ticket_format-D60ae_vA.js";import{a2 as M,a as h,p as V}from"./index-DnFmWr2M.js";import{m as q}from"./proxy-CgUF6eMH.js";import"./ApplicationLogo-tpEwtBlH.js";import"./index-BdO7F12x.js";import"./iconBase-aArZRAXf.js";import"./index-C7UQo0Vh.js";function G({auth:g,subject:y,message:b,priority:f="medium",category:j="general"}){const{t:a}=C(),[k,l]=T.useState(!1),{data:s,setData:i,post:v,processing:x,errors:c,reset:N}=A({subject:y||"",message:b||"",priority:f,category:j,attachments:[]}),w=t=>{t.preventDefault();const r=new FormData;r.append("subject",s.subject),r.append("message",s.message),r.append("priority",s.priority),r.append("category",s.category),s.attachments.forEach((o,n)=>{r.append(`attachments[${n}]`,o)}),v(route("tickets.store"),{data:r,forceFormData:!0,onSuccess:()=>{N(),d.success(a("tickets.created"))},onError:()=>{d.error(a("common.error"))}})},m=t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?l(!0):t.type==="dragleave"&&l(!1)},F=t=>{t.preventDefault(),t.stopPropagation(),l(!1),t.dataTransfer.files&&t.dataTransfer.files[0]&&p(Array.from(t.dataTransfer.files))},p=t=>{const r=t.filter(o=>{const n=["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(o.type),u=o.size<=10*1024*1024;return n||d.error(a("tickets.invalidFileType",{name:o.name})),u||d.error(a("tickets.fileTooLarge",{name:o.name})),n&&u});i("attachments",[...s.attachments,...r])},D=t=>{const r=[...s.attachments];r.splice(t,1),i("attachments",r)};return e.jsxs(S,{auth:{user:{...g.user,roles:g.user.roles||[]}},header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:a("tickets.createNew")}),children:[e.jsx(z,{title:a("tickets.createNew")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-4xl sm:px-6 lg:px-8",children:e.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"overflow-hidden bg-white shadow-sm dark:bg-gray-800 sm:rounded-lg",children:e.jsxs("form",{onSubmit:w,className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"subject",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:a("tickets.subject")}),e.jsx("input",{type:"text",id:"subject",value:s.subject,onChange:t=>i("subject",t.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-indigo-500",required:!0}),c.subject&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.subject})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"priority",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:a("tickets.priority")}),e.jsxs("select",{id:"priority",value:s.priority,onChange:t=>i("priority",t.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-indigo-500",children:[e.jsx("option",{value:"low",children:a("tickets.priority.low")}),e.jsx("option",{value:"medium",children:a("tickets.priority.medium")}),e.jsx("option",{value:"high",children:a("tickets.priority.high")})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"category",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:a("tickets.category")}),e.jsxs("select",{id:"category",value:s.category,onChange:t=>i("category",t.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-indigo-500",children:[e.jsx("option",{value:"general",children:a("tickets.category.general")}),e.jsx("option",{value:"technical",children:a("tickets.category.technical")}),e.jsx("option",{value:"billing",children:a("tickets.category.billing")}),e.jsx("option",{value:"other",children:a("tickets.category.other")})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"message",className:"mb-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:a("tickets.message")}),e.jsx("textarea",{id:"message",value:s.message,onChange:t=>i("message",t.target.value),rows:6,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-indigo-500",required:!0}),c.message&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.message})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-900 dark:text-gray-100",children:a("tickets.attachments")}),e.jsxs("div",{onDragEnter:m,onDragLeave:m,onDragOver:m,onDrop:F,className:`relative flex min-h-[100px] cursor-pointer items-center justify-center rounded-lg border-2 border-dashed p-6 transition-colors ${k?"border-indigo-500 bg-indigo-50 dark:border-indigo-400 dark:bg-indigo-900/20":"border-gray-300 hover:border-gray-400 dark:border-gray-600 dark:hover:border-gray-500"}`,children:[e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"mx-auto mb-2 h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("tickets.dropFiles")}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-500",children:a("tickets.maxFileSize")})]}),e.jsx("input",{type:"file",multiple:!0,onChange:t=>p(Array.from(t.target.files||[])),className:"absolute inset-0 cursor-pointer opacity-0",accept:"image/*,.pdf,.doc,.docx"})]}),s.attachments.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:s.attachments.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-gray-50 p-2 dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.name}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",E(t.size),")"]})]}),e.jsx("button",{type:"button",onClick:()=>D(r),className:"text-gray-400 hover:text-red-500",children:e.jsx(V,{className:"h-4 w-4"})})]},r))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:x,className:"inline-flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50",children:x?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a("common.processing")]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"mr-2 h-4 w-4"}),a("tickets.submit")]})})})]})})})})]})}export{G as default};

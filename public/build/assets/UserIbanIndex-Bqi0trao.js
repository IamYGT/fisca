import{j as e,u as re,r as u,W as se,Y as ie,B as s}from"./app-Cka1RFMC.js";import{S as R,D as ne}from"./SecondaryButton-C-XU3hmi.js";import{M as $}from"./Modal-DLYKP9Sx.js";import{I as f}from"./InputError-Dpua6KD3.js";import{I as y,T as S}from"./TextInput-P8J0krAV.js";import{P as _}from"./PrimaryButton-Dv2XTNwI.js";import{A as le}from"./AuthenticatedLayout-DhEcfMj4.js";import{F as D}from"./index-BEAs7ALE.js";import{G as w}from"./iconBase-DgqZiK0E.js";import"./dialog-CVDvBIJR.js";import"./portal-B3aslO21.js";import"./use-server-handoff-complete-DyF5_kpJ.js";import"./transition-Dmy8fInq.js";import"./ApplicationLogo-CDlIPLAK.js";import"./index-Bay4iaGb.js";import"./proxy-Bs9MHras.js";function de({isOpen:i,onClose:m,onConfirm:g,title:t,children:p,confirmText:l="Sil",cancelText:d="Ä°ptal",processing:x=!1}){return e.jsx($,{show:i,onClose:m,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:t}),e.jsx("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:p}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx(R,{onClick:m,disabled:x,children:d}),e.jsx(ne,{onClick:g,disabled:x,children:l})]})]})})}function O(i){return w({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},child:[]}]})(i)}function oe(i){return w({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(i)}function ce(i){return w({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(i)}function me(i){return w({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(i)}const E=i=>i.replace(/\s/g,"").replace(/(.{4})/g,"$1 ").trim(),xe=i=>{const m=/^TR[0-9]{24}$/,g=i.replace(/\s/g,"").toUpperCase();if(!m.test(g))return!1;const p=(g.slice(4)+g.slice(0,4)).split("").map(d=>{const x=d.charCodeAt(0);return x>=65?x-55:d}).join("");let l="";for(let d=0;d<p.length;d++)l=l+p[d],l=(parseInt(l,10)%97).toString();return parseInt(l,10)===1};function Ee({auth:i,ibans:m,banks:g}){const{t}=re(),[p,l]=u.useState(!1),[d,x]=u.useState(!1),[j,L]=u.useState(null),[k,H]=u.useState(null),[P,U]=u.useState(""),[v,B]=u.useState(!1),[M,T]=u.useState(""),[G,C]=u.useState(!1),[c,I]=u.useState(null),{data:n,setData:h,post:q,put:z,delete:Y,processing:F,errors:b,reset:Z}=se({bank_id:"",iban:"",title:"",is_default:!1,name:"",surname:""}),V=a=>{let r=a.replace(/[^A-Z0-9]/g,"").toUpperCase();r&&!r.startsWith("TR")&&(r="TR"+r),r.length>26&&(r=r.slice(0,26));const o=xe(r);H(o);const A=m.find(W=>W.iban===r&&(!j||j.id!==W.id));A?(B(!0),T(t("iban.alreadyExists")),s.warning(t("iban.alreadyExists"),{position:"top-right",autoClose:3e3})):(B(!1),T("")),r.length===26&&(o&&!A?r!==P&&(s.success(t("iban.validIBAN"),{position:"top-right",autoClose:3e3}),U(r)):o||s.error(t("iban.invalidIBAN"),{position:"top-right",autoClose:3e3})),h("iban",r)},J=a=>{if(a.preventDefault(),!k){s.error(t("iban.errors.invalid_iban"));return}if(v){s.error(t("iban.errors.already_exists"));return}d&&j?z(route("profile.ibans.update",j.id),{onSuccess:()=>{s.success(t("iban.updated")),N()},onError:r=>{Object.values(r).forEach(o=>{o&&s.error(o)})}}):q(route("profile.ibans.store"),{onSuccess:()=>{s.success(t("iban.added")),N()},onError:r=>{Object.values(r).forEach(o=>{o&&s.error(o)})}})},N=()=>{l(!1),x(!1),L(null),Z()},K=a=>{L(a),x(!0),h({bank_id:a.bank_id,iban:a.iban,title:a.title,is_default:a.is_default,name:a.name,surname:a.surname}),l(!0)},Q=a=>{I(a),C(!0)},X=async()=>{if(c)try{await Y(route("profile.ibans.destroy",c.id),{onSuccess:()=>{s.success(t("iban.deleted")),C(!1),I(null)},onError:()=>{s.error(t("iban.errors.delete_failed"))},preserveScroll:!0})}catch{s.error(t("iban.errors.delete_failed"))}},ee=async a=>{try{await navigator.clipboard.writeText(a),s.success(t("common.copied"))}catch{s.error(t("common.copyError"))}},te=async()=>{try{const r=(await navigator.clipboard.readText()).replace(/\s/g,"");V(r),s.success(t("withdrawal.ibanPasted"),{position:"top-right",autoClose:2e3})}catch{s.error(t("withdrawal.pasteError"),{position:"top-right",autoClose:3e3})}},ae=()=>k&&!v&&!F&&n.iban.length===26&&n.bank_id&&n.title&&n.name&&n.surname;return e.jsxs(le,{auth:i,children:[e.jsx(ie,{title:t("iban.management")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm dark:bg-gray-800 sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:t("iban.management")}),e.jsx(_,{onClick:()=>l(!0),children:t("iban.add")})]}),m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center rounded-lg border border-dashed border-gray-300 p-12 text-center dark:border-gray-700",children:[e.jsx(D,{className:"mb-4 h-12 w-12 text-gray-400 dark:text-gray-600"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900 dark:text-white",children:t("iban.noIbans")}),e.jsx("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:t("iban.addFirst")}),e.jsx(_,{onClick:()=>l(!0),children:t("iban.addNew")})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:m.map(a=>{const r=g.find(o=>o.id===a.bank_id);return e.jsxs("div",{className:`group relative overflow-hidden rounded-xl p-6 transition-all duration-300 hover:scale-[1.02] ${a.is_default?"bg-gradient-to-br from-light-primary/10 to-light-accent/5 shadow-lg ring-2 ring-light-primary/20 dark:from-dark-primary/20 dark:to-dark-accent/10 dark:ring-dark-primary/30":"bg-white shadow-md hover:shadow-xl dark:bg-gray-900"}`,children:[a.is_default&&e.jsx("div",{className:"absolute right-0 top-0",children:e.jsxs("div",{className:"flex items-center gap-1 rounded-bl-xl bg-light-primary px-3 py-1 text-white dark:bg-dark-primary",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs font-medium",children:t("iban.default")})]})}),e.jsxs("div",{className:"absolute right-4 top-4 flex space-x-2 opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:[e.jsx("button",{onClick:()=>K(a),className:"rounded-full bg-light-primary/10 p-2 text-light-primary hover:bg-light-primary/20 dark:bg-dark-primary/20 dark:text-dark-primary dark:hover:bg-dark-primary/30",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Q(a),className:"rounded-full bg-red-100 p-2 text-red-600 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400",children:e.jsx(me,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-light-primary/10 p-2 dark:bg-dark-primary/20",children:e.jsx(D,{className:"h-5 w-5 text-light-primary dark:text-dark-primary"})}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:(r==null?void 0:r.name)||t("iban.bankNotFound")})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:t("iban.accountTitle")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:t("iban.accountHolder")}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.name," ",a.surname]})]})]})}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:t("iban.number")}),e.jsx("div",{className:"font-mono text-lg tracking-wider text-gray-700 dark:text-gray-300",children:E(a.iban)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>ee(a.iban),className:"flex items-center gap-1 rounded-lg bg-light-primary/10 px-3 py-1.5 text-sm text-light-primary hover:bg-light-primary/20 dark:bg-dark-primary/20 dark:text-dark-primary dark:hover:bg-dark-primary/30",children:[e.jsx(O,{className:"h-4 w-4"}),t("common.copy")]})})]})]},a.id)})})]})})})}),e.jsx($,{show:p,onClose:N,children:e.jsxs("form",{onSubmit:J,className:"p-6",children:[e.jsx("h2",{className:"mb-6 text-lg font-medium text-gray-900 dark:text-white",children:t(d?"iban.edit":"iban.add")}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"bank_id",value:t("iban.bankSelect")}),e.jsxs("select",{id:"bank_id",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-white sm:text-sm",value:n.bank_id,onChange:a=>h("bank_id",a.target.value),children:[e.jsx("option",{value:"",children:t("common.select")}),g.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx(f,{message:b.bank_id,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"iban",value:t("iban.number")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(oe,{className:`h-5 w-5 ${n.iban.length>0?v?"text-red-500":k?"text-green-500":"text-red-500":"text-gray-400"}`})}),e.jsx("input",{type:"text",value:E(n.iban),onChange:a=>V(a.target.value),placeholder:"TR00 0000 0000 0000 0000 0000 00",className:`block w-full rounded-lg border pl-10 pr-32 uppercase ${n.iban.length>0?v?"border-red-500 focus:border-red-500 focus:ring-red-200":k?"border-green-500 focus:border-green-500 focus:ring-green-200":"border-red-500 focus:border-red-500 focus:ring-red-200":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-200"} dark:border-gray-600 dark:bg-gray-700`,required:!0}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center space-x-1 pr-3",children:e.jsxs("button",{type:"button",onClick:te,className:"flex items-center rounded-md bg-gray-100 px-3 py-1 text-sm text-gray-600 transition-colors hover:bg-gray-200 hover:text-gray-900 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600 dark:hover:text-gray-100",children:[e.jsx(O,{className:"mr-1.5 h-4 w-4"}),t("common.paste")]})})]}),M&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:M}),e.jsx(f,{message:b.iban,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"title",value:t("iban.title")}),e.jsx(S,{id:"title",type:"text",className:"mt-1 block w-full",value:n.title,onChange:a=>h("title",a.target.value)}),e.jsx(f,{message:b.title,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"name",value:t("iban.name")}),e.jsx(S,{id:"name",type:"text",className:"mt-1 block w-full",value:n.name,onChange:a=>h("name",a.target.value)}),e.jsx(f,{message:b.name,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"surname",value:t("iban.surname")}),e.jsx(S,{id:"surname",type:"text",className:"mt-1 block w-full",value:n.surname,onChange:a=>h("surname",a.target.value)}),e.jsx(f,{message:b.surname,className:"mt-2"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900",checked:n.is_default,onChange:a=>h("is_default",a.target.checked)}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:t("iban.setDefault")})]})}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(R,{onClick:N,children:t("common.cancel")}),e.jsx(_,{className:"ml-3",disabled:!ae(),children:t(d?"common.update":"common.save")})]})]})}),e.jsxs(de,{isOpen:G,onClose:()=>{C(!1),I(null)},onConfirm:X,title:t("iban.deleteTitle"),confirmText:t("common.delete"),cancelText:t("common.cancel"),processing:F,children:[e.jsx("p",{children:t("iban.deleteConfirmation",{title:(c==null?void 0:c.title)||"",iban:c?E(c.iban):""})}),(c==null?void 0:c.is_default)&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t("iban.deleteDefaultWarning")})]})]})}export{Ee as default};

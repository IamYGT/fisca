import{u as q,r as d,W as H,j as s,Y as I,y as j,B as h}from"./app-Cka1RFMC.js";import{I as E}from"./InputError-Dpua6KD3.js";import{A as U}from"./AuthenticatedLayout-DhEcfMj4.js";import{Z,B as z,W as C,U as F,e as _,w as K,V as L}from"./index-BDflAi9i.js";import{m as c}from"./proxy-Bs9MHras.js";import"./ApplicationLogo-CDlIPLAK.js";import"./index-Bay4iaGb.js";import"./iconBase-DgqZiK0E.js";function rs({auth:A,user:l}){const{t:e}=q(),[p,N]=d.useState(!1),[x,v]=d.useState(!1),[n,B]=d.useState(0),[m,T]=d.useState(!0),{data:t,setData:w,post:D,processing:g,errors:k}=H({password:"",password_confirmation:""}),S=d.useCallback(r=>{let a=0;return r.length>=8&&a++,r.match(/[a-z]+/)&&a++,r.match(/[A-Z]+/)&&a++,r.match(/[0-9]+/)&&a++,r.match(/[$@#&!]+/)&&a++,a},[]);d.useEffect(()=>{B(S(t.password)),T(t.password===t.password_confirmation)},[t.password,t.password_confirmation,S]);const V=()=>{const a="abcdefghijklmnopqrstuvwxyz",i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",f="0123456789",b="!@#$%^&*()_+-=[]{}|;:,.<>?/~`\"'\\",y=",.!?;:";let o="";o+=a.charAt(Math.floor(Math.random()*a.length)),o+=i.charAt(Math.floor(Math.random()*i.length)),o+=f.charAt(Math.floor(Math.random()*f.length)),o+=b.charAt(Math.floor(Math.random()*b.length)),o+=y.charAt(Math.floor(Math.random()*y.length));const M=a+i+f+b+y;for(let u=o.length;u<16;u++)o+=M.charAt(Math.floor(Math.random()*M.length));o=o.split("").sort(()=>Math.random()-.5).join(""),w(u=>({...u,password:o,password_confirmation:o})),N(!0),v(!0)},W=()=>{navigator.clipboard.writeText(t.password),h.success(e("common.copied"))},$=r=>{r.preventDefault(),m&&n>=3&&D(route("admin.users.reset-password.update",{user:l.id}),{preserveScroll:!0,onSuccess:()=>{j.post(route("admin.users.store-password"),{user_id:l.id,password:t.password,email:l.email},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.success(e("users.resetPasswordSuccess")),j.visit(route("admin.users.index"),{data:{showUserDetails:l.id,tempPassword:t.password},preserveState:!0})},onError:a=>{console.error("Error storing password:",a),h.error(e("users.resetPasswordError"))}})},onError:()=>{h.error(e("users.resetPasswordError"))}})},P={focus:{scale:1.02,transition:{duration:.2}},blur:{scale:1,transition:{duration:.2}}},R=()=>{const r=["#EF4444","#F59E0B","#EAB308","#84CC16","#22C55E"],a=[e("register.passwordVeryWeak"),e("register.passwordWeak"),e("register.passwordMedium"),e("register.passwordStrong"),e("register.passwordVeryStrong")];return s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"mb-1 flex",children:[0,1,2,3,4].map(i=>s.jsx(c.div,{className:"mr-1 h-2 w-1/5 rounded-full",style:{backgroundColor:i<n?r[Math.min(n-1,4)]:"#E5E7EB",transform:`scaleX(${i<n?1:.5})`}},i))}),n>0&&s.jsx("p",{className:"mt-1 text-xs",style:{color:r[Math.min(n-1,4)]},children:a[Math.min(n-1,4)]})]})};return s.jsxs(U,{auth:A,header:s.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:e("users.resetPasswordFor").replace("{name}",l.name)}),children:[s.jsx(I,{title:e("users.resetPassword")}),s.jsx("div",{className:"py-12",children:s.jsx("div",{className:"mx-auto max-w-2xl sm:px-6 lg:px-8",children:s.jsx("div",{className:"overflow-hidden bg-white shadow-xl dark:bg-gray-800 sm:rounded-lg",children:s.jsx("div",{className:"p-8",children:s.jsxs("form",{onSubmit:$,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:e("users.newPassword")}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{type:"button",onClick:V,className:"inline-flex items-center rounded bg-green-600 px-3 py-1 text-xs font-medium text-white hover:bg-green-700",children:[s.jsx(Z,{className:"mr-1"}),e("users.generatePassword")]}),t.password&&s.jsxs("button",{type:"button",onClick:W,className:"inline-flex items-center rounded bg-blue-600 px-3 py-1 text-xs font-medium text-white hover:bg-blue-700",children:[s.jsx(z,{className:"mr-1"}),e("common.copy")]})]})]}),s.jsxs(c.div,{variants:P,whileFocus:"focus",className:"relative mt-1 rounded-md shadow-sm",children:[s.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:s.jsx(C,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{type:p?"text":"password",id:"password",name:"password",value:t.password,onChange:r=>w("password",r.target.value),className:`block w-full rounded-md border border-gray-300 py-2 pl-10 pr-10 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white ${t.password?"font-mono":""}`,required:!0}),s.jsx("button",{type:"button",onClick:()=>N(!p),className:"absolute inset-y-0 right-0 flex items-center pr-3",children:p?s.jsx(F,{className:"h-5 w-5 text-gray-400"}):s.jsx(_,{className:"h-5 w-5 text-gray-400"})})]}),s.jsx(E,{message:k.password,className:"mt-2"}),t.password&&R()]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:e("users.confirmNewPassword")}),s.jsxs(c.div,{variants:P,whileFocus:"focus",className:"relative mt-1 rounded-md shadow-sm",children:[s.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:s.jsx(C,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{type:x?"text":"password",id:"password_confirmation",name:"password_confirmation",value:t.password_confirmation,onChange:r=>w("password_confirmation",r.target.value),className:"block w-full rounded-md border border-gray-300 py-2 pl-10 pr-10 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:!0}),s.jsx("button",{type:"button",onClick:()=>v(!x),className:"absolute inset-y-0 right-0 flex items-center pr-3",children:x?s.jsx(F,{className:"h-5 w-5 text-gray-400"}):s.jsx(_,{className:"h-5 w-5 text-gray-400"})})]}),s.jsx(E,{message:k.password_confirmation,className:"mt-2"}),!m&&t.password_confirmation&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:e("users.passwordsDontMatch")})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",onClick:()=>j.visit(route("admin.users.index")),className:"inline-flex items-center rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700",children:e("common.cancel")}),s.jsxs(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:g||!m||n<3,className:`inline-flex items-center rounded-md border border-transparent px-4 py-2 text-sm font-semibold text-white ${g||!m||n<3?"cursor-not-allowed bg-gray-400":"bg-blue-600 hover:bg-blue-700"} `,children:[g?s.jsx(K,{className:"mr-2 h-5 w-5 animate-spin"}):s.jsx(L,{className:"mr-2 h-5 w-5"}),e("users.resetPassword")]})]})]})})})})})]})}export{rs as default};
